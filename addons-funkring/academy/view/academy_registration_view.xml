<?xml version="1.0" encoding="UTF-8"?>
<openerp>
  <data>

    <record id="form_academy_registration" model="ir.ui.view">
      <field name="name">academy.form_academy_registration</field>
      <field name="model">academy.registration</field>
      <field name="arch" type="xml">
        <form string="Registration" version="7.0">
            <header>
                <button type="object" name="do_register" states="draft" string="Register" class="oe_highlight"/>
                <button type="object" name="do_cancel" states="registered,assigned,open" string="DeRegister"/>
                <button type="object" name="do_draft" states="cancel" string="To Draft"/>
                <field name="state" widget="statusbar"
                       statusbar_visible="draft,registered,assigned,open"
                       statusbar_colors="{'cancel':'red'}"/>
            </header>
            <sheet>
                <div class="oe_title">
                    <label for="name" class="oe_edit_only"/>
                    <h1>
                        <field name="name"/>
                    </h1>
                </div>
                <group>
                    <group>
                        <field name="year_id"/>
                        <field name="student_id"/>
                        <field name="location_id"/>
                        <field name="student_of_loc"/>
                    </group>
                    <group>                   
                        <field name="invoice_address_id"/>     
                        <field name="course_prod_id" on_change="onchange_course_prod(course_prod_id, uom_id, context)"/>
                        <field name="course_uom_ids" invisible="1"/>
                        <field name="uom_id" domain="[('id','in',course_uom_ids[0][2])]"/>
                        <field name="amount"/>                        
                    </group>
                    <group string="Assignment">
                        <field name="course_id"/>
                        <field name="trainer_id"/>
                    </group>
                    <group string="Editing">
                        <field name="create_date"/>
                        <field name="user_id"/>                                                
                    </group>
                </group>
            </sheet>
            <div class="oe_chatter">
                <field name="message_follower_ids" widget="mail_followers" />
                <field name="message_ids" widget="mail_thread" />
            </div>
        </form>
      </field>
    </record>

    <record id="tree_academy_registration" model="ir.ui.view">
      <field name="name">academy.tree_academy_registration</field>
      <field name="model">academy.registration</field>
      <field name="arch" type="xml">
        <tree string="Registrations">
            <field name="name"/>
            <field name="year_id"/>
            <field name="student_id"/>
            <field name="location_id"/>
            <field name="course_prod_id"/>
            <field name="uom_id"/>
            <field name="amount"/>
            <field name="invoice_address_id"/>
            <field name="course_id"/>
            <field name="trainer_id"/>
            <field name="create_date"/>
        </tree>
      </field>
    </record>

    <record id="search_academy_registration" model="ir.ui.view">
      <field name="name">academy.search_academy_registration</field>
      <field name="model">academy.registration</field>
      <field name="arch" type="xml">
        <search string="Search Registration">
          <field name="name" filter_domain="['|','|','|','|',('year','ilike',self),('student_id','ilike',self),('location_id','ilike',self),('course_prod_id','ilike',self),('trainer_id','ilike',self)]" string="Registration"/>
          <separator/>
          <field name="year_id"/>
          <field name="student_id"/>
          <field name="location_id"/>
          <field name="course_prod_id"/>
          <field name="trainer_id"/>
          <separator/>
          <field name="state"/>
          <group expand="0" string="Group By...">
            <filter string="Location" context="{'group_by': 'location_id'}"/>
            <filter string="Trainer" context="{'group_by': 'trainer_id'}"/>
            <filter string="Product" context="{'group_by': 'course_prod_id'}"/>
            <filter string="State" context="{'group_by': 'state'}"/>
          </group>
        </search>
      </field>
    </record>

    <record id="action_academy_registration" model="ir.actions.act_window">
      <field name="name">Registration</field>
      <field name="res_model">academy.registration</field>
      <field name="view_type">form</field>
      <field name="view_mode">tree,form</field>
      <field name="help" type="html">
        <p class="oe_view_nocontent_create">
          Click here to create a new registration.
        </p>
      </field>
    </record>

    <menuitem id="menu_academy_registration" name="Registration" parent="menu_academy_management"
      sequence="3"
      action="action_academy_registration"/>

  </data>
</openerp>
