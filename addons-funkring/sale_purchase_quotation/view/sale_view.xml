<?xml version="1.0" encoding="utf-8"?>
<openerp>
   <data>
 
       <record id="form_sale_order" model="ir.ui.view">
         <field name="name">sale_purchase_quotation.form_sale_order</field>
         <field name="model">sale.order</field>
         <field name="inherit_id" ref="at_sale.form_sale_order" />
         <field name="arch" type="xml">
            <data>
                <xpath expr="/form/sheet/notebook/page[@string='Order Lines']/field[@name='order_line']/tree" position="attributes">
                   <attribute name="editable" />
                </xpath>

                <!--
                <xpath expr="/form/sheet/notebook/page[@string='Order Lines']/field[@name='order_line']/form/header/button[@string='Invoice']" position="after">
                    <button name="start_quotation" type="object" string="Request Supplier"
                            attrs="{'invisible' : ['|',('quotation_active','=',True),('state','!=','draft')]}" />

                    <button name="recreate_quotation" type="object" string="Request Supplier"
                            attrs="{'invisible' : ['|',('quotation_active','=',False),('state','!=','draft')]}"
                            confirm="Do you really want to recreate all supplier requests?" />
                </xpath> -->

                <group name="seller_options_grp" position="inside">
                    <field name="quotation_active" invisible="1" />
                    <field name="quotation_all" invisible="1" />

                    <group colspan="2" cols="4">

                        <button name="start_quotation" type="object" string="Request Supplier" 
                                attrs="{'invisible' : ['|',('quotation_active','=',True),('state','!=','draft')]}"
                                colspan="2" />

                        <button name="recreate_quotation" type="object" string="Request Supplier" 
                                attrs="{'invisible' : ['|',('quotation_active','=',False),('state','!=','draft')]}"
                                confirm="Do you really want to recreate all supplier requests?"
                                colspan="2" />

                    </group>
                </group>

                <field name="supplier_id" position="replace">
                    <field name="supplier_id" options="{'reload_on_button': true}"
                           domain="[('id','in',available_supplier_ids[0][2])]"
                           attrs="{'invisible' : [('quotation_active','=',True)]} "
                           />
                </field>

                <xpath expr="/form/sheet/notebook/page[@string='Order Lines']/field[@name='order_line']/form/group[@name='seller_grp']"  position="after">
                    <div attrs="{'invisible' : [('quotation_active','=',False)]}">
                        <label for="quotation_ids" />
                        <field name="quotation_ids" nolabel="1" colspan="4" options="{'reload_on_button': true}">
                             <tree string="Supplier Details" editable="bottom" colors="blue:quot_selected == True">
                            
                               <button  name="assign_selected_partner" type="object" string="Select"
                                  attrs="{'readonly' : [('quot_selected','=',True)]}" />
                              
                               <button  name="send_mail_supplier_one" type="object" string="Send E-mail"
                                  attrs="{'readonly' : ['|',('quot_sent','=',True),('state', 'in', ('confirmed','approved','done'))] }"/>
                                  
                               <field name="partner_id" />
                               <field name="price_unit" />
                               <field name="pricelist_price" />
                               
                               <field name="quot_sent" invisible="1"/>
                               <field name="quot_selected" invisible="1"/>
                               <field name="state" invisible="1"/>
                            </tree>
                        </field>
                    </div>
                    <group colspan="4">
                        <div class="oe_right oe_button_box">
                            <field name="quotation_active" invisible="1"/>
                            <button name="send_mail_supplier" type="object" string="Send E-mail to all Suppliers"
                                    attrs="{'invisible' : [('quotation_active','=',False),'|',('state','!=','draft'),('quotation_all','=',True)]}"
                                    confirm="Do you really want to send email to all suppliers?" />
                         </div>
                     </group>

                </xpath>

            </data>
         </field>
      </record>

    
   </data>
</openerp>